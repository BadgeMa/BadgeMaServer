<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="declarationSQL">
	<select id="selectDeclaration" parameterType="hashmap"
		resultType="hashmap">
		<![CDATA[
			SELECT
			    *
			FROM
			   Declaration
		]]>
	</select>
	<select id="selectBtnNumber" parameterType="hashmap"
		resultType="hashmap">
		<![CDATA[
			SELECT
			    count(*) as num
			FROM
			   Declaration
			WHERE
				declaration_date=#{declaration_date} AND 
				declaration_type=#{declaration_type}
		]]>
	</select>
	<select id="selectVoteList" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
			SELECT
			    *
			FROM
			   OnePercentVote
		]]>
	</select>
	<insert id="insertVote" parameterType="hashmap">
	<![CDATA[
	    	IF EXISTS(
                SELECT user_id FROM OnePercentVote
                WHERE vote_date=#{vote_date} AND user_id = #{user_id}
         	)
    	BEGIN
        	SELECT 99 cnt
    	END
    
    	ELSE
        	BEGIN
        	INSERT
				INTO OnePercentVote(
			    	vote_date,
			    	user_id,
			    	vote_answer
			    	)
				VALUES(
			    	#{vote_date},
			    	#{user_id},
			    	#{vote_answer}
			    )
       	END
		]]>
		
	</insert>
	


	<update id="updateLetterState" parameterType="hashmap">
		<![CDATA[
			UPDATE
				letter_tb
			SET
				read_state=1
			WHERE
				letter_id=#{letter_id}
		]]>
	</update>
	<delete id="deleteDeclaration" parameterType="hashmap">
		<![CDATA[
			DELETE FROM
				Declaration
			WHERE
				declaration_id=#{declaration_id}
		]]>
	</delete>








</mapper>